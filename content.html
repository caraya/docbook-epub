<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Ebooks: From Docbook to ePub and Kindle too</title><meta name="generator" content="DocBook XSL 2.0 Stylesheets V2.0.3" /><link rel="stylesheet" type="text/css" href="http://docbook.github.com/release/2.0.3/base/css/default.css" /><script type="text/javascript" src="http://docbook.github.com/release/2.0.3/base/js/dbmodnizr.js"></script></head><body><article id="R.1" lang="en" class="book"><header class="book-titlepage"><h1>Ebooks: From Docbook to ePub and Kindle too</h1><div class="author"><h3><span class="personname"><span class="firstname">Carlos</span> <span class="surname">Araya</span></span></h3></div></header><hr /><div class="toc"><p><b>Table of Contents</b></p><ul class="toc"><li><span><a href="#R.1.3">1. Publishing for everyone</a></span></li><li><span><a href="#R.1.4">1. Why should I create an ebook? Why with Docbook?</a></span><ul class="toc"><li><span><a href="#R.1.4.5">Why Docbook?</a></span><ul class="toc"><li><span><a href="#R.1.4.5.3">Is Docbook the only alternative for creating ebooks?</a></span></li></ul></li></ul></li><li><span><a href="#R.1.5">2. Creating your Docbook content</a></span></li><li><span><a href="#R.1.6">3. Converting the XML into different formats</a></span><ul class="toc"><li><span><a href="#R.1.6.3">Converting to ePub 2</a></span></li><li><span><a href="#R.1.6.4">Making an ePub3 ebook </a></span></li><li><span><a href="#R.1.6.5">Let's not forget the Kindle</a></span></li></ul></li><li><span><a href="#R.1.7">4. Customizing the generated HTML</a></span></li><li><span><a href="#R.1.8">5. Automating the process</a></span><ul class="toc"><li><span><a href="#R.1.8.2">Apache Ant and making things easier on yourself</a></span></li><li><span><a href="#R.1.8.3">One little addition or substractions</a></span></li><li><span><a href="#R.1.8.4">The final build file</a></span></li></ul></li><li><span><a href="#R.1.9">6. Publishing your content</a></span></li><li><span><a href="#R.1.10">References</a></span></li></ul></div><article id="R.1.3" class="preface"><header class="preface-titlepage"><h2>Publishing for everyone</h2><h2>Trying to get down to a definition of publishing</h2></header><p>Publishing is no longer the province of big publishers or that crazy people who dream of writing a book and find out that the only way to get published is to do it themselves. Well, we all can publish our work with tools like Docbook,  formats like ePub and publishers like Amazon.</p><p>We all have something to publish. We all have something to tell the world.</p><p>I chose to publish my content using Docbook because of it's flexibility. While we're talking only about ePub and Kindle publishing, Docbook can generate a variety of other formats using the same tools that we are using to generate our ePub content. You can learn more about Docbook and the associated XSLT style sheets at <a href="http://www.docbook.org/">http://www.docbook.org/</a>.</p><p>This e-book seeks to answer three questions that, to me, are essential to a successful publishing endeavor:</p><div class="itemizedlist"><ul><li>Why should I publish my own content?</li><li>Why should I use Docbook to do it?</li><li>How do I create my ebook using this tools?</li></ul></div><p>In answering these questions my hope is that you will create new content and give it to the world. I'm sure we'll all be much better for it</p></article><article id="R.1.4" class="chapter"><header class="chapter-titlepage"><h2>Chapter 1. Why should I create an ebook? Why with Docbook?</h2></header><div class="toc"><p><b>Table of Contents</b></p><ul class="toc"><li><span><a href="#R.1.4.5">Why Docbook?</a></span><ul class="toc"><li><span><a href="#R.1.4.5.3">Is Docbook the only alternative for creating ebooks?</a></span></li></ul></li></ul></div><p>Again, We all have something to say to the world. And ebooks make it easier than ever to have the world as your audience. Whatever form your message takes we can build a book and a community around it. We have different technologies to communicate before, during and after creating our content and we are given plenty of opportunities to engage with our readers during the process.</p><p>Take bloggers for example. We can leverage our blog as a development platform for written content with multiple drafts and selectively, based on the feedback received from readers, can use the best content as part of our book or books. We have not only authored the content of the book months or years in advance but we have also built a community of people who are vested in the content we author.</p><p>We can also engage the community as co-authors of our content. With proper clearance we can edit the users' comments into the narrative that we initially wrote on our blog and weave a fuller narrative about our content. We can further refine the content by making the result of our collaboration available to the community and further edit the book thus it becoming a living document that evolves according to what the community sees as new. </p><section id="R.1.4.5" class="sect1"><div class="section-titlepage"><h2>Why Docbook?</h2></div><p>Content is required in chapters too.</p><section id="R.1.4.5.3" class="sect2"><div class="section-titlepage"><h3>Is Docbook the only alternative for creating ebooks?</h3></div><p>No, it isn't.</p></section></section></article><article id="R.1.5" class="chapter"><header class="chapter-titlepage"><h2>Chapter 2. Creating your Docbook content</h2></header><p>Content is required in chapters too.</p><div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;?xml version="1.0" encoding="utf-8"?&gt;
<span class="linenumber">  2</span><span class="linenumber-separator"> </span>&lt;book 
<span class="linenumber">   </span><span class="linenumber-separator"> </span>	xmlns='http://docbook.org/ns/docbook' 
<span class="linenumber">  4</span><span class="linenumber-separator"> </span>	xmlns:xlink='http://www.w3.org/1999/xlink'
<span class="linenumber">   </span><span class="linenumber-separator"> </span>	version="5.0" xml:lang="en"&gt;
<span class="linenumber">  6</span><span class="linenumber-separator"> </span>&lt;title&gt;Using From Docbook to ePub and Kindle too&lt;/title&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;info&gt;
<span class="linenumber">  8</span><span class="linenumber-separator"> </span>	&lt;author&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>		&lt;personname&gt;
<span class="linenumber"> 10</span><span class="linenumber-separator"> </span>			&lt;firstname&gt;Carlos&lt;/firstname&gt;&lt;surname&gt;Araya&lt;/surname&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>		&lt;/personname&gt;
<span class="linenumber"> 12</span><span class="linenumber-separator"> </span>	&lt;/author&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>	&lt;/info&gt;
<span class="linenumber"> 14</span><span class="linenumber-separator"> </span>&lt;chapter&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;title&gt;Required Title&lt;/title&gt;
<span class="linenumber"> 16</span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;para&gt;Required paragraph.&lt;/para&gt;
<span class="linenumber"> 18</span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/chapter&gt;</pre></div></article><article id="R.1.6" class="chapter"><header class="chapter-titlepage"><h2>Chapter 3. Converting the XML into different formats</h2></header><div class="toc"><p><b>Table of Contents</b></p><ul class="toc"><li><span><a href="#R.1.6.3">Converting to ePub 2</a></span></li><li><span><a href="#R.1.6.4">Making an ePub3 ebook </a></span></li><li><span><a href="#R.1.6.5">Let's not forget the Kindle</a></span></li></ul></div><p>something interesting goes here</p><section id="R.1.6.3" class="sect1"><div class="section-titlepage"><h2>Converting to ePub 2</h2></div><p>Content is required in chapters too.</p></section><section id="R.1.6.4" class="sect1"><div class="section-titlepage"><h2>Making an ePub3 ebook </h2></div><p>Content is required in chapters too.</p></section><section id="R.1.6.5" class="sect1"><div class="section-titlepage"><h2>Let's not forget the Kindle</h2></div><p>Content is required in chapters too.</p></section></article><article id="R.1.7" class="chapter"><header class="chapter-titlepage"><h2>Chapter 4. Customizing the generated HTML</h2></header><p>Content is required in chapters too.</p></article><article id="R.1.8" class="chapter"><header class="chapter-titlepage"><h2>Chapter 5. Automating the process</h2></header><div class="toc"><p><b>Table of Contents</b></p><ul class="toc"><li><span><a href="#R.1.8.2">Apache Ant and making things easier on yourself</a></span></li><li><span><a href="#R.1.8.3">One little addition or substractions</a></span></li><li><span><a href="#R.1.8.4">The final build file</a></span></li></ul></div><section id="R.1.8.2" class="sect1"><div class="section-titlepage"><h2>Apache Ant and making things easier on yourself</h2></div><p>I love Apache Ant</p></section><section id="R.1.8.3" class="sect1"><div class="section-titlepage"><h2>One little addition or substractions</h2></div><p>Because I'm paranoid and I like to build my book over and over I found out a problem. If I accidentally delete any of the directories that Docbook creates for me, the build process will fail. However, removing the existing files and directories is essential to ensure that only the latest version of our generated files makes it into the ebook.</p><p>I decided to use the If ant task from the Ant Contrib Project. Download links and instructions for installing the additional tasks and configuring your build file to use them see <a href="http://ant-contrib.sourceforge.net/">http://ant-contrib.sourceforge.net/</a>.</p><p>The <em>if</em> task acts as a conditional if. It allows a task to branch out based in a condition, in our case if a directory exists. If it does then go ahead and delete everything (Docbook will never create the directory we're using for the condition alone); if it doesn't exist then print a message and do nothing.</p><p>if you do not want to use the if task for whatever reason you will have to make the following changes:</p><p>Remove <em>&lt;taskdef resource="net/sf/antcontrib/antcontrib.properties"/&gt;</em> from your build file.</p><p>Remove <em>&lt;antcall target="epub-clean"/&gt;</em> from bot the epub and epub3 targets. This call will cause the build to fail if any of the files or directories are missing. You will have to run this task manually before building the book.</p><p>Change the epub-clean target from this:</p><div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;target name="epub-clean"&gt;
<span class="linenumber">  2</span><span class="linenumber-separator"> </span>&lt;description&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>	Cleans up leftover epub stuff
<span class="linenumber">  4</span><span class="linenumber-separator"> </span>&lt;/description&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;if&gt;
<span class="linenumber">  6</span><span class="linenumber-separator"> </span>	&lt;available file="OEBPS" type="dir" /&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>	&lt;then&gt;
<span class="linenumber">  8</span><span class="linenumber-separator"> </span>		&lt;echo message="Directory exist... deleting" /&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>		&lt;delete verbose="true"&gt;
<span class="linenumber"> 10</span><span class="linenumber-separator"> </span>			&lt;fileset dir="OEBPS" includes="*"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>			&lt;fileset dir="META-INF" includes="*"/&gt;
<span class="linenumber"> 12</span><span class="linenumber-separator"> </span>		&lt;/delete&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>		&lt;delete verbose="true" file="mimetype"/&gt;
<span class="linenumber"> 14</span><span class="linenumber-separator"> </span>		&lt;delete verbose="true" dir="META-INF"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>		&lt;delete verbose="true" dir="OEBPS"/&gt;
<span class="linenumber"> 16</span><span class="linenumber-separator"> </span>		&lt;delete verbose="true" file="${src_file}.epub"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>	&lt;/then&gt;
<span class="linenumber"> 18</span><span class="linenumber-separator"> </span>	&lt;else&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>		&lt;echo message="Directory DOES NOT exist... Nothing to delete" /&gt;
<span class="linenumber"> 20</span><span class="linenumber-separator"> </span>	&lt;/else&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/if&gt;
<span class="linenumber"> 22</span><span class="linenumber-separator"> </span>&lt;/target&gt;</pre></div><p>to this:</p><div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;target name="epub-clean"&gt;
<span class="linenumber">  2</span><span class="linenumber-separator"> </span>&lt;description&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>	Cleans up leftover epub stuff
<span class="linenumber">  4</span><span class="linenumber-separator"> </span>&lt;/description&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;delete verbose="true"&gt;
<span class="linenumber">  6</span><span class="linenumber-separator"> </span>	&lt;fileset dir="OEBPS" includes="*"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>	&lt;fileset dir="META-INF" includes="*"/&gt;
<span class="linenumber">  8</span><span class="linenumber-separator"> </span>&lt;/delete&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;delete verbose="true" file="mimetype"/&gt;
<span class="linenumber"> 10</span><span class="linenumber-separator"> </span>&lt;delete verbose="true" dir="META-INF"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;delete verbose="true" dir="OEBPS"/&gt;
<span class="linenumber"> 12</span><span class="linenumber-separator"> </span>&lt;delete verbose="true" file="${src_file}.epub"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/then&gt;
<span class="linenumber"> 14</span><span class="linenumber-separator"> </span>&lt;/target&gt;</pre></div><p>Notice how we've removed the if, available, then and else tags on the epub-clean tag.</p></section><section id="R.1.8.4" class="sect1"><div class="section-titlepage"><h2>The final build file</h2></div><p>After adding the if task the complete build file looks like this:</p><div class="programlisting"><pre><span class="linenumber">  1</span><span class="linenumber-separator"> </span>&lt;project name="epub" default="epub3" basedir="."&gt;
<span class="linenumber">  2</span><span class="linenumber-separator"> </span>&lt;description&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>Apache ant build file for Docbook based ebooks
<span class="linenumber">  4</span><span class="linenumber-separator"> </span>&lt;/description&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!-- Created by Carlos Araya as part of his eBook research --&gt;
<span class="linenumber">  6</span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!-- Required for the IF Task --&gt;
<span class="linenumber">  8</span><span class="linenumber-separator"> </span>&lt;taskdef resource="net/sf/antcontrib/antcontrib.properties"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!-- Change the value of src_file to the name of your ebook file without extension--&gt;
<span class="linenumber"> 10</span><span class="linenumber-separator"> </span>&lt;property name="src_file" value="docbook-howto"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!-- Configure the path to the docbook stylesheets--&gt;
<span class="linenumber"> 12</span><span class="linenumber-separator"> </span>&lt;property name="docbook_path" value="/usr/local/docbook/1.0/xslt/"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber"> 14</span><span class="linenumber-separator"> </span>&lt;!-- Put the name of the binaries that you're using that are not stock on OS X--&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;property name="epubcheck_bin" value="/usr/local/java/epubcheck/epubcheck-3.0b4.jar"/&gt;
<span class="linenumber"> 16</span><span class="linenumber-separator"> </span>&lt;property name="kindlegen_bin" value="/usr/local/kindlegen/kindlegen"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber"> 18</span><span class="linenumber-separator"> </span>&lt;target name="epub2"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;description&gt;
<span class="linenumber"> 20</span><span class="linenumber-separator"> </span>	Convert the XML file into epub2 using a snapshot of the stylesheets
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/description&gt;
<span class="linenumber"> 22</span><span class="linenumber-separator"> </span>&lt;!-- Remove prior versions of the content we're generating --&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;antcall target="epub-clean"/&gt;
<span class="linenumber"> 24</span><span class="linenumber-separator"> </span>&lt;!-- Validate XML --&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;antcall target="validate-xml"/&gt;
<span class="linenumber"> 26</span><span class="linenumber-separator"> </span>&lt;!-- Run the stylesheet conversion --&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;exec executable="xsltproc"&gt;
<span class="linenumber"> 28</span><span class="linenumber-separator"> </span>	&lt;arg line="${docbook_path}epub/docbook.xsl ${src_file}.xml"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/exec&gt;
<span class="linenumber"> 30</span><span class="linenumber-separator"> </span>&lt;!-- Create mimetype file, required per epub spec --&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;antcall target="make-mime"/&gt;
<span class="linenumber"> 32</span><span class="linenumber-separator"> </span>&lt;!-- zips the fills for the epub --&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;antcall target="epub-zip"/&gt;
<span class="linenumber"> 34</span><span class="linenumber-separator"> </span>&lt;!-- Runs epubcheck on the epub file --&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;antcall target="epub-check"/&gt;
<span class="linenumber"> 36</span><span class="linenumber-separator"> </span>&lt;!-- Creates a Kindle version of the book --&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;antcall target="make-kindle"/&gt;
<span class="linenumber"> 38</span><span class="linenumber-separator"> </span>&lt;/target&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber"> 40</span><span class="linenumber-separator"> </span>&lt;target name="epub3"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;description&gt;
<span class="linenumber"> 42</span><span class="linenumber-separator"> </span>	Convert the XML file into epub3 using a snapshot of the stylesheets. 
<span class="linenumber">   </span><span class="linenumber-separator"> </span>	We do it with snapshot because epub3 support is still experimental
<span class="linenumber"> 44</span><span class="linenumber-separator"> </span>&lt;/description&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!-- Remove prior versions of the content we're generating --&gt;
<span class="linenumber"> 46</span><span class="linenumber-separator"> </span>&lt;antcall target="epub-clean"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!-- Validate XML --&gt;
<span class="linenumber"> 48</span><span class="linenumber-separator"> </span>&lt;antcall target="validate-xml"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!-- Run the xslt transformation... we should be able to use the XSLT ant task but xsltproc is faster --&gt;
<span class="linenumber"> 50</span><span class="linenumber-separator"> </span>&lt;exec executable="xsltproc"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>	&lt;arg line="--stringparam base.dir OEBPS/ ${docbook_path}epub3/chunk.xsl ${src_file}.xml"/&gt;
<span class="linenumber"> 52</span><span class="linenumber-separator"> </span>&lt;/exec&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!-- zips the fils for the epub --&gt;
<span class="linenumber"> 54</span><span class="linenumber-separator"> </span>&lt;antcall target="epub-zip"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!-- Runs epubcheck on the epub file --&gt;
<span class="linenumber"> 56</span><span class="linenumber-separator"> </span>&lt;antcall target="epub-check"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/target&gt;
<span class="linenumber"> 58</span><span class="linenumber-separator"> </span>
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber"> 60</span><span class="linenumber-separator"> </span>&lt;!-- Utility targets called from elsewhere epub2 and/or epub3 targets--&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;target name="make-mime"&gt;
<span class="linenumber"> 62</span><span class="linenumber-separator"> </span>&lt;!-- Creates mimetype file as required by epub spec--&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;echo file="mimetype"&gt;application/epub+zip&lt;/echo&gt;
<span class="linenumber"> 64</span><span class="linenumber-separator"> </span>&lt;/target&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber"> 66</span><span class="linenumber-separator"> </span>&lt;target name="make-kindle"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;exec executable="${kindlegen_bin}"&gt;
<span class="linenumber"> 68</span><span class="linenumber-separator"> </span>	&lt;arg line="${src_file}.epub"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/exec&gt;
<span class="linenumber"> 70</span><span class="linenumber-separator"> </span>&lt;/target&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber"> 72</span><span class="linenumber-separator"> </span>&lt;target name="epub-zip"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;!-- We use exec zip because I can't figure out if the builtin zip task conforms to what ePub expects --&gt;
<span class="linenumber"> 74</span><span class="linenumber-separator"> </span>&lt;!-- Zip the mimetype first without compression as required--&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;exec executable="zip"&gt;
<span class="linenumber"> 76</span><span class="linenumber-separator"> </span>&lt;arg line="-X0 ${src_file}.epub mimetype"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/exec&gt;
<span class="linenumber"> 78</span><span class="linenumber-separator"> </span>&lt;!-- Then zip the other files into the zip/epub archive --&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;exec executable="zip"&gt;
<span class="linenumber"> 80</span><span class="linenumber-separator"> </span>&lt;arg line="-r -X9 ${src_file}.epub META-INF OEBPS"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/exec&gt;
<span class="linenumber"> 82</span><span class="linenumber-separator"> </span>&lt;/target&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber"> 84</span><span class="linenumber-separator"> </span>&lt;target name="epub-check"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;java jar="${epubcheck_bin}" fork="true" failonerror="true" maxmemory="128m"&gt;
<span class="linenumber"> 86</span><span class="linenumber-separator"> </span>	&lt;arg value="${src_file}.epub"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/java&gt;
<span class="linenumber"> 88</span><span class="linenumber-separator"> </span>&lt;/target&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber"> 90</span><span class="linenumber-separator"> </span>&lt;!-- Cleans up leftover epub stuff--&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;target name="epub-clean"&gt;
<span class="linenumber"> 92</span><span class="linenumber-separator"> </span>&lt;description&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>	Cleans up leftover epub stuff
<span class="linenumber"> 94</span><span class="linenumber-separator"> </span>&lt;/description&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;if&gt;
<span class="linenumber"> 96</span><span class="linenumber-separator"> </span>	&lt;available file="OEBPS" type="dir" /&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>	&lt;then&gt;
<span class="linenumber"> 98</span><span class="linenumber-separator"> </span>		&lt;echo message="Directory exist... deleting" /&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>		&lt;delete verbose="true"&gt;
<span class="linenumber">100</span><span class="linenumber-separator"> </span>			&lt;fileset dir="OEBPS" includes="*"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>			&lt;fileset dir="META-INF" includes="*"/&gt;
<span class="linenumber">102</span><span class="linenumber-separator"> </span>		&lt;/delete&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>		&lt;delete verbose="true" file="mimetype"/&gt;
<span class="linenumber">104</span><span class="linenumber-separator"> </span>		&lt;delete verbose="true" dir="META-INF"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>		&lt;delete verbose="true" dir="OEBPS"/&gt;
<span class="linenumber">106</span><span class="linenumber-separator"> </span>		&lt;delete verbose="true" file="${src_file}.epub"/&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>	&lt;/then&gt;
<span class="linenumber">108</span><span class="linenumber-separator"> </span>	&lt;else&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>		&lt;echo message="Directory DOES NOT exist... Nothing to delete" /&gt;
<span class="linenumber">110</span><span class="linenumber-separator"> </span>	&lt;/else&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/if&gt;
<span class="linenumber">112</span><span class="linenumber-separator"> </span>&lt;/target&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>
<span class="linenumber">114</span><span class="linenumber-separator"> </span>&lt;!-- We call xmllint to make sure that the XML validates--&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;target name="validate-xml"&gt;
<span class="linenumber">116</span><span class="linenumber-separator"> </span>&lt;exec executable="xmllint"&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>	&lt;arg line="-noent -noout ${src_file}.xml"/&gt;
<span class="linenumber">118</span><span class="linenumber-separator"> </span>&lt;/exec&gt;
<span class="linenumber">   </span><span class="linenumber-separator"> </span>&lt;/target&gt;
<span class="linenumber">120</span><span class="linenumber-separator"> </span>&lt;/project&gt;</pre></div></section></article><article id="R.1.9" class="chapter"><header class="chapter-titlepage"><h2>Chapter 6. Publishing your content</h2></header><p>This is where we talk about publishing your content yourself, publishing to Amazon and, maybe, to the iBooks store</p></article><article class="bibliography"><header class="bibliography-titlepage"><h2>References</h2></header><div class="bibliomixed"><p>[] 
	<span class="bibliomset">Sayton, Robert.
 		<cite>XSL: The Definitive Guide</cite>.
	</span>
	<span class="bibliomset">
		<cite>The World Wide Web Journal</cite>
		<span class="volumenum">2</span><span class="issuenum">1</span>.
		<span class="publishername">O'Reilly &amp; Associates, Inc.</span> and The World Wide Web Consortium. Winter, 1996</span>.
	</p></div></article></article></body></html>